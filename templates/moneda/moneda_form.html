{% extends 'base/base.html' %}
{% load staticfiles %}
{% block content %}
<!--
 <script>

    $(document).ready(
            function() {
                 

                setInterval(function() {
                    
                     var lista=[];
                     var lista2=[];
                     var lista3=[];
                     var lista4=[];
                             
                            $("#myTable tbody tr").each(function(){
                                var lista4={};
                                var tds=$(this).find("td");
                                lista4.Name=tds.filter(":eq(0)").text();
                                lista4.Cantidad=tds.filter(":eq(3)").text();
                                lista3.push(lista4);
                                
                            });
                             
                            $(".symbol").each(function(){
					            var monto = String($(this).text());
					            lista.push(monto);                      
					                                
					        });

					         for(i=0;i<lista.length;i++){
                                for(j=0;j<lista3.length;j++){
                                    
                                    if(lista[i]==lista3[j].Name){
                                    	//$('.cantidad').val(lista3[j].Cantidad);
                                    	console.log(lista[i])
                                    	//console.log(lista3[j])
                                    }
                                    

                                }
                                
                                
                            }
                            

                            //console.log(lista3)
                            //console.log(lista)
                            //console.log(lista2)
                              
                    
                }, 5000);
            });
    </script>-->
				


				<script>
					$(document).ready(function(){
				    $(".boton").click(function() {
				    	 
				        var valores = "";
				        var usd="";
				        var btc="";
				        var x=0;
				        var i=0;
				        var lista=[];
	                     var lista2=[];
	                     var lista3=[];
	                     var lista4=[];   
	                              
                            
	                     $("#myTable tbody tr").each(function(){
                                var lista4={};
                                var tds=$(this).find("td");
                                lista4.Name=tds.filter(":eq(0)").text();
                                lista4.Cantidad=tds.filter(":eq(3)").text();
                                lista3.push(lista4);
                                
                          });                   

	                                       

				        // Obtenemos todos los valores contenidos en los <td> de la fila
				        // seleccionada
				        $(this).parents("tr").find(".symbol").each(function() {
				          valores = $(this).text();
				          
				          
				          $('.simbolo').hide();
				          $("."+valores).toggle();
				          $('.symbolo').val(valores);

				          
				   
				           
				          
				          	
				          	var cont=0;
				          	var cont1=0;
                             for(i=0;i<lista3.length;i++){                   
                                    


                                    
                                    if (valores == lista3[i].Name){
                                        //console.log(lista3[i].Name)
                                        var cont=i+1;
                                        //console.log(cont)
                                        //console.log(valores)

                                    }                             
                                                              
                               }

                               

                                if (cont==0){
                                	$('.cantidad').val("0");
                                	
                                }

                                $('.cantidad').val(lista3[cont-1].Cantidad);

                                //console.log(lista3[cont-1].Cantidad)
                                
                            
				          	


				          		
				          	
				          //}                       
                                                 
                          //for (x in lista3) {
                          	//if (valores==lista3[x].Name){
					    	//$('.cantidad').val(lista3[x].Cantidad);
					    	//console.log(lista3[x].Cantidad)
					    	//}

					    //}
				        
			       		});   

				        

                       
			           $(this).parents("tr").find(".nombre").each(function() {
				          name = $(this).html() + "\n";
				          
				          
				          $('.name').val(name);
				          
				        
				        });
				        $(this).parents("tr").find(".usd").each(function() {
				          usd = $(this).html() + "\n";
				          
				          
				          $('.preciousd').val(usd);
				          
				        
				        });

				        $(this).parents("tr").find(".btc").each(function() {
				          btc = $(this).html() + "\n";
				          
				          
				          $('.preciobtc').val(btc);
				          
				        
				        });
				        
				        
				      });
				    });
				</script>	

		<table class="table table-bordered" id="myTable" style="display: none;">

			<thead>
				<tr>
					<td>#</td>
					<td>Cargo</td>
					<td>Imagen</td>
					
					
					<td>Acciones</td>
				</tr>
			</thead>

			<tbody>
			{% if monedas %}
			
			{% for moneda in monedas%}

				

				<tr>
					<td ><label for="" class="symbol1">{{moneda.symbol}}</label></td>
					<td>{{moneda.preciousd}}</td>
					<td>{{moneda.preciobtc}}</td>
					<td class="cantidad1">{{moneda.cantidad}}</td>
					
					
					
				</tr>
			{% endfor %}
			{% else %}
			<h1>No hay registros de cargos</h1>
			{% endif%}
			</tbody>

		</table>

      <!-- Example DataTables Card-->
      <div class="card mb-3">
        <div class="card-header">
          <i class="fa fa-table"></i> Cryptocurrency</div>
        <div class="card-body" id="card">
          <div class="table-responsive" id="prueba1">
             <table class="table table-hover" id="dataTable" width="100%" cellspacing="0">
            <thead>
                <tr>
                	<th style="display: none;">Simbolo</th>
					<th>Name</th>
					<th>Precio</th>
					<th>Precio BTC</th>
					<th>Cambio</th>
					<th>Operacion</th>
				</tr>
              </thead>
              <tfoot>
               <tr>
               		<th style="display: none;">Simbolo</th>
					<th>Name</th>
					<th>Precio</th>
					<th>Precio BTC</th>
					<th>Cambio</th>
					<th>Operacion</th>
				</tr>
              </tfoot>
              <tbody>
			

			 
			{% for coin in crypto_data %}
				
				<tr >
					<td class="symbol" style="display: none;">{{coin.symbol}}</td>
					<td class="nombre">{{coin.name}}</td>
					<td class="usd">{{coin.price_usd}}</td>
					<td class="btc">{{coin.price_btc}}</td>
					<td><label for="">{{coin.percent_change_1h}}</label></td>
					<td><input type="button" value="Seleccionar" class="btn btn-primary boton"></td>

				</tr>
				
				<tr  class="simbolo {{coin.symbol}}" style="background: #E0E0E0;display: none;">
				
					<form method="POST" id="guardaru" enctype="multipart/form-data">
						{% csrf_token %}
						
						<td>
						<fieldset class="form-group">
						    <label for="Moneda">Moneda</label>
						    {{form.symbol}}
						    {{form.name}}
					  	</fieldset>
						</td>
						<td>
						<fieldset class="form-group">
						    <label for="Moneda">Precio USD</label>
						    {{form.preciousd}}
					  	</fieldset>
						</td>
						<td>
						<fieldset class="form-group">
						    <label for="Moneda">Precio BTC</label>
						    {{form.preciobtc}}
					  	</fieldset>
						</td>
						
						<td>
						
						<fieldset class="form-group">
						    <label for="Moneda">Cantidad</label>
						    {{form.cantidad}}
					  	</fieldset>
					  	
						</td>
						
						<td style="padding-top:20px;">
						<fieldset class="form-group">
							<button type="submit" class="btn btn-success" id="enviar">Registrar</button>
							
					  	</fieldset>
					  	<fieldset class="form-group">
							
							<a class="btn btn-info" href="{% url 'moneda:moneda_info' coin.symbol%}">Ver mas</a>
					  	</fieldset>
						

						</td>



					</form>

					
				</tr>
			

				
				
			
			{% endfor %}


			</tbody>
           
             
			
            </table>	
          </div>
        </div>
        <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
      </div>
    




{% endblock %}